

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Resource Check &mdash; Teflo 0.1.2 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_override.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'0.1.2',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Credentials" href="credentials.html" />
    <link rel="prev" title="Scenario Descriptor" href="../scenario_descriptor.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Teflo
          

          
          </a>

          
            
            
              <div class="version">
                0.1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation &amp; Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install Teflo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configure Teflo</a></li>
</ul>
<p class="caption"><span class="caption-text">Using Teflo</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">User’s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html#detailed-information">Detailed Information</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../scenario_descriptor.html">Scenario Descriptor</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Resource Check</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#monitored-services">Monitored_Services</a></li>
<li class="toctree-l4"><a class="reference internal" href="#playbook-script">Playbook/ Script</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-1">Example 1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-2">Example 2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="credentials.html">Credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="include.html">Including Scenarios</a></li>
<li class="toctree-l3"><a class="reference internal" href="provision.html">Provision</a></li>
<li class="toctree-l3"><a class="reference internal" href="orchestrate.html">Orchestrate</a></li>
<li class="toctree-l3"><a class="reference internal" href="execute.html">Execute</a></li>
<li class="toctree-l3"><a class="reference internal" href="report.html">Report</a></li>
<li class="toctree-l3"><a class="reference internal" href="notifications.html">Notification</a></li>
<li class="toctree-l3"><a class="reference internal" href="timeout.html">Timeout settings for Teflo Tasks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data_pass_through.html">Data Pass-through</a></li>
<li class="toctree-l2"><a class="reference internal" href="../output.html">Teflo Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../best_practices.html">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../localhost.html">Using Localhost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_data.html">Using Jinja Variable Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resource_labels.html">Using Resource Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faqs.html">FAQS</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Teflo Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../developers/index.html">Developer’s Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contacts</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Teflo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">User’s Guide</a> &raquo;</li>
        
          <li><a href="../scenario_descriptor.html">Scenario Descriptor</a> &raquo;</li>
        
      <li>Resource Check</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/users/definitions/resource_check.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="resource-check">
<h1>Resource Check<a class="headerlink" href="#resource-check" title="Permalink to this headline">¶</a></h1>
<p>Teflo’s Resource Dependency Check Section is optional. It is run during the Validate task
Resource_check is a dictionary which takes in three keys <strong>monitored_services (formerly was service), playbook, script</strong></p>
<div class="section" id="monitored-services">
<h2>Monitored_Services<a class="headerlink" href="#monitored-services" title="Permalink to this headline">¶</a></h2>
<p>User can define a list of external components to check if their status is up or not.
if all components are up the scenario will be executed .If one or more components are
down the scenario will exit with an error. It will also indicate if a component name
given is invalid.</p>
<p>The key “resource_check_endpoint” must be set in the teflo.cfg file to actually
perform check. If not set this section is ignored. The “resource_check_endpoint”
must be the URL of a “Cachet” status page endpoint. Component names must be valid
for that status page</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">defaults</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">log_level=info</span>
<span class="l l-Scalar l-Scalar-Plain">workspace=.</span>
<span class="l l-Scalar l-Scalar-Plain">data_folder=.teflo</span>
<span class="l l-Scalar l-Scalar-Plain">resource_check_endpoint=&lt;URL&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="playbook-script">
<h2>Playbook/ Script<a class="headerlink" href="#playbook-script" title="Permalink to this headline">¶</a></h2>
<p>User can put in a list of customized playbooks or scripts to validate certain things
before starting their scenario. if any of the user defined validation playbook/scripts
fail the scenario will not be run.</p>
<p>All playbooks and scripts are run only on the localhost from where teflo is being executed.
Teflo will not be able to take any output from these scripts/playbooks and make any
decisions based on that
Teflo will consider the resource _check successfull or not based on the return code received
after running the playbook or script</p>
<p>Teflo uses the ansible to run these playbooks and scripts. User should define playbooks and
scripts similar to how it is defined in the <a class="reference external" href="./execute.html">Execute</a> section of Teflo</p>
</div>
<div class="section" id="example-1">
<h2>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h2>
<p>Using service, playbook, script</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
<span class="n">name</span><span class="p">:</span> <span class="n">Example</span> <span class="n">Discriptor</span>
<span class="n">description</span><span class="p">:</span> <span class="n">Descriptor</span> <span class="n">file</span> <span class="k">with</span> <span class="n">resource</span> <span class="n">check</span> <span class="n">section</span>

<span class="n">resource_check</span><span class="p">:</span>
  <span class="n">monitored_services</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">polarion</span>
    <span class="o">-</span> <span class="n">umb</span>
  <span class="n">playbook</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">ansible</span><span class="o">/</span><span class="n">list_block_devices</span><span class="o">.</span><span class="n">yml</span>
      <span class="n">ansible_options</span><span class="p">:</span>
        <span class="n">extra_vars</span><span class="p">:</span>
          <span class="n">X</span><span class="p">:</span> <span class="mi">18</span>
          <span class="n">Y</span><span class="p">:</span> <span class="mi">12</span>
          <span class="n">ch_dir</span><span class="p">:</span> <span class="o">./</span><span class="n">scripts</span><span class="o">/</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">ansible</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">test_execute_playbook</span><span class="o">.</span><span class="n">yml</span>
      <span class="n">ansible_options</span><span class="p">:</span>
        <span class="n">extra_vars</span><span class="p">:</span>
          <span class="n">X</span><span class="p">:</span> <span class="mi">12</span>
          <span class="n">Y</span><span class="p">:</span> <span class="mi">12</span>
          <span class="n">ch_dir</span><span class="p">:</span> <span class="o">../../</span><span class="n">scripts</span><span class="o">/</span>
  <span class="n">script</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">hello_world1</span><span class="o">.</span><span class="n">py</span> <span class="n">Teflo_user</span>
        <span class="n">executable</span><span class="p">:</span> <span class="n">python</span>
      <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">add_two_numbers</span><span class="o">.</span><span class="n">sh</span> <span class="n">X</span><span class="o">=</span><span class="mi">15</span> <span class="n">Y</span><span class="o">=</span><span class="mi">15</span>


<span class="n">provision</span><span class="p">:</span>
   <span class="o">.</span>
   <span class="o">.</span>
   <span class="o">.</span>

<span class="n">orchestrate</span><span class="p">:</span>
   <span class="o">.</span>
   <span class="o">.</span>
   <span class="o">.</span>

<span class="n">execute</span><span class="p">:</span>
   <span class="o">.</span>
   <span class="o">.</span>
   <span class="o">.</span>

</pre></div>
</div>
</div>
<div class="section" id="example-2">
<h2>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h2>
<p>Using service</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">Example</span> <span class="n">Discriptor</span>
<span class="n">description</span><span class="p">:</span> <span class="n">Descriptor</span> <span class="n">file</span> <span class="k">with</span> <span class="n">resource</span> <span class="n">check</span> <span class="n">section</span>

<span class="n">resource_check</span><span class="p">:</span>
  <span class="n">monitored_services</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;polarion&#39;</span><span class="p">,</span> <span class="s1">&#39;umb&#39;</span><span class="p">]</span>

<span class="n">provision</span><span class="p">:</span>
   <span class="o">.</span>
   <span class="o">.</span>
   <span class="o">.</span>

<span class="n">orchestrate</span><span class="p">:</span>
   <span class="o">.</span>
   <span class="o">.</span>
   <span class="o">.</span>

</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="credentials.html" class="btn btn-neutral float-right" title="Credentials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../scenario_descriptor.html" class="btn btn-neutral float-left" title="Scenario Descriptor" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Red Hat Inc.

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>